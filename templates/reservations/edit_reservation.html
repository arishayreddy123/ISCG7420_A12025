{% extends "base.html" %}
{% block title %}Edit Reservation{% endblock %}

{% block content %}
  <!-- heading with room name -->
  <h2>Edit Reservation for {{ res.room.name }}</h2>

  <!-- date picker to reload available slots -->
  <div class="field">
    <label for="date">Select date:</label>
    <input
      type="date"
      id="date"
      name="date"
      value="{{ sel_date }}"
      min="{{ min_date }}"
      onchange="location='?date='+this.value"
    >
  </div>

  <!-- form to choose new time slot -->
  <form method="post">
    {% csrf_token %}
    <!-- time slot dropdown -->
    <label>Choose time slot:</label>
    <select name="time_slot">
      {% for slot in slots %}
        {% if slot.free or slot.start == res.start_time %}
          <option
            value="{{ slot.start|date:'c' }}|{{ slot.end|date:'c' }}"
            {% if slot.start == res.start_time %}selected{% endif %}
          >
            {{ slot.start|time:"H:i" }}â€“{{ slot.end|time:"H:i" }}
          </option>
        {% endif %}
      {% endfor %}
    </select>

    <!-- action buttons -->
    <div class="actions">
      <!-- save changes -->
      <button class="btn btn-primary" type="submit">Save</button>
      <!-- cancel and return to list -->
      <a class="btn btn-secondary" href="{% url 'reservations:my_reservations' %}">Cancel</a>
    </div>
  </form>
{% endblock %}
